description: |
  Detects powershell scripts that import modules from suspicious directories
name: Import PowerShell Modules From Suspicious Directories - ProcCreation
index: "winlogbeat-*"
filter:
- query:
    query_string:
      query: process.command_line.keyword:(*import\-module\ \"$env\:temp\\* OR *import\-module\ '$env\:temp\\* OR *import\-module\ $env\:temp\\* OR *import\-module\ \"$env\:appdata\\* OR *import\-module\ '$env\:appdata\\* OR *import\-module\ $env\:appdata\\* OR *import\-module\ c\:\\users\\public\\* OR *ipmo\ \"$env\:temp\\* OR *ipmo\ '$env\:temp\\* OR *ipmo\ $env\:temp\\* OR *ipmo\ \"$env\:appdata\\* OR *ipmo\ '$env\:appdata\\* OR *ipmo\ $env\:appdata\\* OR *ipmo\ c\:\\users\\public\\*)
type: any
priority: 2
