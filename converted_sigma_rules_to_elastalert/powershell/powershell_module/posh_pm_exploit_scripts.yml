description: |
  Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance
name: Malicious PowerShell Scripts - PoshModule
index: "winlogbeat-*"
filter:
- query:
    query_string:
      query: (winlog.event_data.ContextInfo.keyword:(*add\-constraineddelegationbackdoor.ps1* OR *add\-exfiltration.ps1* OR *add\-persistence.ps1* OR *add\-regbackdoor.ps1* OR *add\-remoteregbackdoor.ps1* OR *add\-scrnsavebackdoor.ps1* OR *check\-vm.ps1* OR *convertto\-rot13.ps1* OR *copy\-vss.ps1* OR *create\-multiplesessions.ps1* OR *dns_txt_pwnage.ps1* OR *dnscat2.ps1* OR *do\-exfiltration.ps1* OR *domainpasswordspray.ps1* OR *download_execute.ps1* OR *download\-execute\-ps.ps1* OR *enabled\-duplicatetoken.ps1* OR *enable\-duplicatetoken.ps1* OR *execute\-command\-mssql.ps1* OR *execute\-dnstxt\-code.ps1* OR *execute\-ontime.ps1* OR *exetotext.ps1* OR *exploit\-jboss.ps1* OR *find\-avsignature.ps1* OR *find\-fruit.ps1* OR *find\-gpolocation.ps1* OR *find\-trusteddocuments.ps1* OR *firebuster.ps1* OR *firelistener.ps1* OR *get\-applicationhost.ps1* OR *get\-chromedump.ps1* OR *get\-clipboardcontents.ps1* OR *get\-computerdetail.ps1* OR *get\-foxdump.ps1* OR *get\-gppautologon.ps1* OR *get\-gpppassword.ps1* OR *get\-indexeditem.ps1* OR *get\-keystrokes.ps1* OR *get\-lsasecret.ps1* OR *get\-microphoneaudio.ps1* OR *get\-passhashes.ps1* OR *get\-passhints.ps1* OR *get\-regalwaysinstallelevated.ps1* OR *get\-regautologon.ps1* OR *get\-rickastley.ps1* OR *get\-screenshot.ps1* OR *get\-securitypackages.ps1* OR *get\-servicefilepermission.ps1* OR *get\-servicepermission.ps1* OR *get\-serviceunquoted.ps1* OR *get\-sitelistpassword.ps1* OR *get\-system.ps1* OR *get\-timedscreenshot.ps1* OR *get\-unattendedinstallfile.ps1* OR *get\-unconstrained.ps1* OR *get\-usbkeystrokes.ps1* OR *get\-vaultcredential.ps1* OR *get\-vulnautorun.ps1* OR *get\-vulnschtask.ps1* OR *get\-webconfig.ps1* OR *get\-webcredentials.ps1* OR *get\-wlan\-keys.ps1* OR *gupt\-backdoor.ps1* OR *http\-backdoor.ps1* OR *http\-login.ps1* OR *install\-servicebinary.ps1* OR *install\-ssp.ps1* OR *invoke\-aclscanner.ps1* OR *invoke\-adsbackdoor.ps1* OR *invoke\-amsibypass.ps1* OR *invoke\-arpscan.ps1* OR *invoke\-backdoorlnk.ps1* OR *invoke\-badpotato.ps1* OR *invoke\-bettersafetykatz.ps1* OR *invoke\-bruteforce.ps1* OR *invoke\-bypassuac.ps1* OR *invoke\-carbuncle.ps1* OR *invoke\-certify.ps1* OR *invoke\-conptyshell.ps1* OR *invoke\-credentialinjection.ps1* OR *invoke\-credentialsphish.ps1* OR *invoke\-daft.ps1* OR *invoke\-dcsync.ps1* OR *invoke\-decode.ps1* OR *invoke\-dinvokekatz.ps1* OR *invoke\-dllinjection.ps1* OR *invoke\-downgradeaccount.ps1* OR *invoke\-egresscheck.ps1* OR *invoke\-encode.ps1* OR *invoke\-eventviewer.ps1* OR *invoke\-eyewitness.ps1* OR *invoke\-fakelogonscreen.ps1* OR *invoke\-farmer.ps1* OR *invoke\-get\-rbcd\-threaded.ps1* OR *invoke\-gopher.ps1* OR *invoke\-grouper2.ps1* OR *invoke\-grouper3.ps1* OR *invoke\-handlekatz.ps1* OR *invoke\-interceptor.ps1* OR *invoke\-internalmonologue.ps1* OR *invoke\-inveigh.ps1* OR *invoke\-inveighrelay.ps1* OR *invoke\-jsratregsvr.ps1* OR *invoke\-jsratrundll.ps1* OR *invoke\-krbrelay.ps1* OR *invoke\-krbrelayup.ps1* OR *invoke\-ldapsigncheck.ps1* OR *invoke\-lockless.ps1* OR *invoke\-malsccm.ps1* OR *invoke\-mimikatz.ps1* OR *invoke\-mimikatzwdigestdowngrade.ps1* OR *invoke\-mimikittenz.ps1* OR *invoke\-mitm6.ps1* OR *invoke\-nanodump.ps1* OR *invoke\-netripper.ps1* OR *invoke\-networkrelay.ps1* OR *invoke\-ninjacopy.ps1* OR *invoke\-oxidresolver.ps1* OR *invoke\-p0wnedshell.ps1* OR *invoke\-p0wnedshellx86.ps1* OR *invoke\-paranoia.ps1* OR *invoke\-portscan.ps1* OR *invoke\-poshrathttp.ps1* OR *invoke\-poshrathttps.ps1* OR *invoke\-postexfil.ps1* OR *invoke\-powerdump.ps1* OR *invoke\-powershellicmp.ps1* OR *invoke\-powershelltcp.ps1* OR *invoke\-powershelltcponeline.ps1* OR *invoke\-powershelltcponelinebind.ps1* OR *invoke\-powershelludp.ps1* OR *invoke\-powershelludponeline.ps1* OR *invoke\-powershellwmi.ps1* OR *invoke\-powerthief.ps1* OR *invoke\-ppldump.ps1* OR *invoke\-prasadhak.ps1* OR *invoke\-psexec.ps1* OR *invoke\-psgcat.ps1* OR *invoke\-psgcatagent.ps1* OR *invoke\-psinject.ps1* OR *invoke\-psuacme.ps1* OR *invoke\-reflectivepeinjection.ps1* OR *invoke\-reversednslookup.ps1* OR *invoke\-rubeus.ps1* OR *invoke\-runas.ps1* OR *invoke\-safetykatz.ps1* OR *invoke\-sauroneye.ps1* OR *invoke\-scshell.ps1* OR *invoke\-seatbelt.ps1* OR *invoke\-serviceabuse.ps1* OR *invoke\-sessiongopher.ps1* OR *invoke\-shellcode.ps1* OR *invoke\-smbscanner.ps1* OR *invoke\-snaffler.ps1* OR *invoke\-spoolsample.ps1* OR *invoke\-sshcommand.ps1* OR *invoke\-ssidexfil.ps1* OR *invoke\-standin.ps1* OR *invoke\-stickynotesextract.ps1* OR *invoke\-tater.ps1* OR *invoke\-thunderfox.ps1* OR *invoke\-thunderstruck.ps1* OR *invoke\-tokenmanipulation.ps1* OR *invoke\-tokenvator.ps1* OR *invoke\-totalexec.ps1* OR *invoke\-urbanbishop.ps1* OR *invoke\-userhunter.ps1* OR *invoke\-voicetroll.ps1* OR *invoke\-whisker.ps1* OR *invoke\-winenum.ps1* OR *invoke\-winpeas.ps1* OR *invoke\-wiretap.ps1* OR *invoke\-wmicommand.ps1* OR *invoke\-wscriptbypassuac.ps1* OR *invoke\-zerologon.ps1* OR *keylogger.ps1* OR *mailraider.ps1* OR *new\-honeyhash.ps1* OR *officememscraper.ps1* OR *offline_winpwn.ps1* OR *out\-chm.ps1* OR *out\-dnstxt.ps1* OR *out\-excel.ps1* OR *out\-hta.ps1* OR *out\-java.ps1* OR *out\-js.ps1* OR *out\-minidump.ps1* OR *out\-rundllcommand.ps1* OR *out\-scf.ps1* OR *out\-sct.ps1* OR *out\-shortcut.ps1* OR *out\-webquery.ps1* OR *out\-word.ps1* OR *parse_keys.ps1* OR *port\-scan.ps1* OR *powerbreach.ps1* OR *powercat.ps1* OR *powerrunassystem.psm1* OR *powersharppack.ps1* OR *powerup.ps1* OR *powerupsql.ps1* OR *powerview.ps1* OR *psasyncshell.ps1* OR *remotehashretrieval.ps1* OR *remove\-persistence.ps1* OR *remove\-poshrat.ps1* OR *remove\-update.ps1* OR *run\-exeonremote.ps1* OR *schtasks\-backdoor.ps1* OR *set\-dcshadowpermissions.ps1* OR *set\-macattribute.ps1* OR *set\-remotepsremoting.ps1* OR *set\-remotewmi.ps1* OR *set\-wallpaper.ps1* OR *show\-targetscreen.ps1* OR *speak.ps1* OR *start\-captureserver.ps1* OR *start\-webcamrecorder.ps1* OR *stringtobase64.ps1* OR *texttoexe.ps1* OR *veeam\-get\-creds.ps1* OR *volumeshadowcopytools.ps1* OR *winpwn.ps1* OR *wsuspendu.ps1*)) OR (winlog.event_data.ContextInfo.keyword:*invoke\-sharp* AND winlog.event_data.ContextInfo.keyword:*.ps1*)
type: any
priority: 3
