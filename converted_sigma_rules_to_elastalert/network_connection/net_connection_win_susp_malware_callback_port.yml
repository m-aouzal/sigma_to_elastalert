description: |
  Detects programs that connect to known malware callback ports based on statistical analysis from two different sandbox system databases

name: Potentially Suspicious Malware Callback Communication
index: winlogbeat-*
filter:
- query:
    query_string:
      query: (network.direction.keyword:true AND (destination.port:(100 OR 198 OR
        200 OR 243 OR 473 OR 666 OR 700 OR 743 OR 777 OR 1443 OR 1515 OR 1777 OR 1817
        OR 1904 OR 1960 OR 2443 OR 2448 OR 3360 OR 3675 OR 3939 OR 4040 OR 4433 OR
        4438 OR 4443 OR 4444 OR 4455 OR 5445 OR 5552 OR 5649 OR 6625 OR 7210 OR 7777
        OR 8143 OR 8843 OR 9631 OR 9943 OR 10101 OR 12102 OR 12103 OR 12322 OR 13145
        OR 13394 OR 13504 OR 13505 OR 13506 OR 13507 OR 14102 OR 14103 OR 14154 OR
        49180 OR 65520 OR 65535))) AND (NOT (destination.ip.keyword:127.0.0.0\/8 OR
        destination.ip.keyword:10.0.0.0\/8 OR destination.ip.keyword:172.16.0.0\/12
        OR destination.ip.keyword:192.168.0.0\/16 OR destination.ip.keyword:169.254.0.0\/16
        OR destination.ip.keyword:\:\:1\/128 OR destination.ip.keyword:fe80\:\:\/10
        OR destination.ip.keyword:fc00\:\:\/7)) AND (NOT (process.executable.keyword:(c\:\\program\
        files\\* OR c\:\\program\ files\ \(x86\)\\*)))
type: any
priority: 3
mitre_attack_tactic:
- persistence
- command-and-control
mitre_attack_technique:
- t1571
risk: high
